<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Meixner</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Meixner_files/libs/clipboard/clipboard.min.js"></script>
<script src="Meixner_files/libs/quarto-html/quarto.js"></script>
<script src="Meixner_files/libs/quarto-html/popper.min.js"></script>
<script src="Meixner_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Meixner_files/libs/quarto-html/anchor.min.js"></script>
<link href="Meixner_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Meixner_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Meixner_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Meixner_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Meixner_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Meixner_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="Meixner_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#justificación" id="toc-justificación" class="nav-link active" data-scroll-target="#justificación">Justificación</a></li>
  <li><a href="#cálculo-de-los-log-rendimientos-diarios" id="toc-cálculo-de-los-log-rendimientos-diarios" class="nav-link" data-scroll-target="#cálculo-de-los-log-rendimientos-diarios">Cálculo de los log-rendimientos diarios</a></li>
  <li><a href="#cálculo-de-descriptivos" id="toc-cálculo-de-descriptivos" class="nav-link" data-scroll-target="#cálculo-de-descriptivos">Cálculo de descriptivos</a></li>
  <li><a href="#gráfico-de-densidad-histograma-boxplot-y-velas" id="toc-gráfico-de-densidad-histograma-boxplot-y-velas" class="nav-link" data-scroll-target="#gráfico-de-densidad-histograma-boxplot-y-velas">Gráfico de densidad, histograma, boxplot y velas</a>
  <ul class="collapse">
  <li><a href="#historico" id="toc-historico" class="nav-link" data-scroll-target="#historico">Historico</a>
  <ul class="collapse">
  <li><a href="#histograma-historico" id="toc-histograma-historico" class="nav-link" data-scroll-target="#histograma-historico">Histograma historico</a></li>
  <li><a href="#boxplot-historico" id="toc-boxplot-historico" class="nav-link" data-scroll-target="#boxplot-historico">Boxplot historico</a></li>
  <li><a href="#gráfico-de-velas-historico" id="toc-gráfico-de-velas-historico" class="nav-link" data-scroll-target="#gráfico-de-velas-historico">Gráfico de velas historico</a></li>
  </ul></li>
  <li><a href="#primer-trimestre-q1-2025" id="toc-primer-trimestre-q1-2025" class="nav-link" data-scroll-target="#primer-trimestre-q1-2025">Primer trimestre (Q1) 2025</a>
  <ul class="collapse">
  <li><a href="#histograma-q3---2025" id="toc-histograma-q3---2025" class="nav-link" data-scroll-target="#histograma-q3---2025">Histograma Q3 - 2025</a></li>
  <li><a href="#boxplot-q1-2025" id="toc-boxplot-q1-2025" class="nav-link" data-scroll-target="#boxplot-q1-2025">Boxplot Q1 2025</a></li>
  <li><a href="#grafico-de-velas-q1-2023" id="toc-grafico-de-velas-q1-2023" class="nav-link" data-scroll-target="#grafico-de-velas-q1-2023">Grafico de velas Q1 2023</a></li>
  </ul></li>
  <li><a href="#marzo-2025" id="toc-marzo-2025" class="nav-link" data-scroll-target="#marzo-2025">Marzo 2025</a>
  <ul class="collapse">
  <li><a href="#histograma-marzo---2025" id="toc-histograma-marzo---2025" class="nav-link" data-scroll-target="#histograma-marzo---2025">Histograma Marzo - 2025</a></li>
  <li><a href="#boxplot-marzo-2025" id="toc-boxplot-marzo-2025" class="nav-link" data-scroll-target="#boxplot-marzo-2025">Boxplot Marzo 2025</a></li>
  <li><a href="#gráfico-de-velas-marzo-2025" id="toc-gráfico-de-velas-marzo-2025" class="nav-link" data-scroll-target="#gráfico-de-velas-marzo-2025">Gráfico de velas Marzo 2025</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimación-de-parámetros-gaussianos-agregar-densidades-qqplot-y-distribución-empírica" id="toc-estimación-de-parámetros-gaussianos-agregar-densidades-qqplot-y-distribución-empírica" class="nav-link" data-scroll-target="#estimación-de-parámetros-gaussianos-agregar-densidades-qqplot-y-distribución-empírica">Estimación de parámetros Gaussianos: Agregar densidades, qqplot y distribución empírica</a></li>
  <li><a href="#pruebita" id="toc-pruebita" class="nav-link" data-scroll-target="#pruebita">Pruebita</a></li>
  <li><a href="#estimación-de-parámetros-meixner-agregar-densidades-qqplot-y-distribución-empírica" id="toc-estimación-de-parámetros-meixner-agregar-densidades-qqplot-y-distribución-empírica" class="nav-link" data-scroll-target="#estimación-de-parámetros-meixner-agregar-densidades-qqplot-y-distribución-empírica">Estimación de parámetros Meixner: Agregar densidades, qqplot y distribución empírica</a>
  <ul class="collapse">
  <li><a href="#momentos-empiricos" id="toc-momentos-empiricos" class="nav-link" data-scroll-target="#momentos-empiricos">Momentos Empiricos</a></li>
  <li><a href="#función-objetivo" id="toc-función-objetivo" class="nav-link" data-scroll-target="#función-objetivo">Función objetivo</a></li>
  <li><a href="#ajuste" id="toc-ajuste" class="nav-link" data-scroll-target="#ajuste">Ajuste</a></li>
  </ul></li>
  <li><a href="#resolución-numérica-de-la-ecuación-martingala-meixner" id="toc-resolución-numérica-de-la-ecuación-martingala-meixner" class="nav-link" data-scroll-target="#resolución-numérica-de-la-ecuación-martingala-meixner">Resolución numérica de la ecuación martingala Meixner</a></li>
  <li><a href="#densidades-meixner-y-gaussiano-en-el-mundo-riesgo-neutro" id="toc-densidades-meixner-y-gaussiano-en-el-mundo-riesgo-neutro" class="nav-link" data-scroll-target="#densidades-meixner-y-gaussiano-en-el-mundo-riesgo-neutro">Densidades Meixner y Gaussiano en el mundo riesgo neutro</a></li>
  <li><a href="#prima-black-scholes-europea" id="toc-prima-black-scholes-europea" class="nav-link" data-scroll-target="#prima-black-scholes-europea">Prima Black-Scholes Europea</a></li>
  <li><a href="#prima-meixner-europea" id="toc-prima-meixner-europea" class="nav-link" data-scroll-target="#prima-meixner-europea">Prima Meixner Europea</a></li>
  <li><a href="#prima-americana-arbol-forward" id="toc-prima-americana-arbol-forward" class="nav-link" data-scroll-target="#prima-americana-arbol-forward">Prima Americana Arbol Forward</a></li>
  <li><a href="#simulaciones-gaussianas" id="toc-simulaciones-gaussianas" class="nav-link" data-scroll-target="#simulaciones-gaussianas">Simulaciones Gaussianas</a></li>
  <li><a href="#simulaciones-meixner" id="toc-simulaciones-meixner" class="nav-link" data-scroll-target="#simulaciones-meixner">Simulaciones Meixner</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Meixner</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="justificación" class="level1">
<h1>Justificación</h1>
<p>Grupo Carso y Grupo Financiero Inbursa son dos entidades emblemáticas del empresariado mexicano. Grupo Carso se consolidó como un conglomerado industrial y comercial diversificado, mientras que Grupo Financiero Inbursa se especializó en servicios financieros integrales.</p>
<p>Grupo Carso se constituyó formalmente en 1980, durante está decáda se expandió en negocios industriales y de consumo como: la tabacalera Cigatam, la llantera Euzkadi, la minera Frisco y el fabricante de cables Condume.Un hito crucial llegó en 1990, cuando adquirió el control de Teléfonos de México (Telmex) durante su privatización. Grupo Carso salió a bolsa en 1990 y continuó creciendo con la compra de la mayoría de acciones de empresas como Sanborns. A partir de 1996, el conglomerado decidió escindir sus operaciones de telecomunicaciones en una entidad separada (Carso Global Telecom, hoy parte de América Móvil) , manteniendo en Grupo Carso negocios diversificados en comercio, industria, energía e infraestructura.</p>
<p>Por su parte, Grupo Financiero Inbursa se constituyó en septiembre de 1992, agrupando banco, casa de bolsa, aseguradora y afore principalmente. En los años siguientes, Inbursa añadió nuevas líneas de negocio: fundó Banco Inbursa (1993) y empresas de arrendamiento y factoraje; lanzó la Afore Inbursa en 1996 al establecerse el sistema de pensiones privado; e incluso incursionó en alianzas estratégicas, como la compra de Banco Walmart en 2015 para ampliar su presencia en banca de consumo.</p>
<p>A lo largo de sus décadas de operación, Grupo Carso ha experimentado un crecimiento económico notable, convirtiéndose en uno de los conglomerados más grandes e importantes de México y América Latina. Un indicador de su escala actual son sus ingresos: en 2023, las ventas consolidadas de Grupo Carso alcanzaron aproximadamente 198,455 millones de pesos, con crecimiento anual de 9.3%, además en 2023 registró una utilidad neta de $ 13,519 millones de pesos. Asimismo, grupo Carso genera alrededor de 250 mil empleos directos y más de 500 mil indirectos en México, contribuyendo al desarrollo económico y social más allá de las cifras puramente financieras.</p>
<p>Grupo Financiero Inbursa, por su parte, durante el 2015 ya se posicionaba entre las instituciones más importantes en el país, con aproximadamente 327,547 millones de pesos en activos y una cartera de crédito total de 237,479 mdp. Esta trayectoria ascendente continuó en la última década, pues al cierre de 2023, los activos de Inbursa superaban los 578 mil millones de pesos, equivalentes a 4.22% de los activos de todo el sistema bancario mexicano. En la misma fecha, su cartera de crédito de cerca 360 mil millones representaba 5.3% de los préstamos bancarios del país. La utilidad neta en 2023 fue de $30,985 millones de pesos, un incremento notable frente a $24,495 millones del año anterior. Cabe destacar que, de acuerdo a la Comisión Nacional Bancaria y de Valores, Banco Inbursa ha sido designado en 2024 como “institución de importancia sistémica local”, entrando al selecto grupo de bancos cuya relevancia es tal que su eventual riesgo podría impactar la estabilidad financiera nacional. Tal clasificación compartida con gigantes como BBVA, Banamex, Banorte, Santander, HSBC y Scotiabank.</p>
<p>En el caso específico de Inbursa, su participación de mercado en banca lo sitúa consistentemente entre los primeros 5 o 6 bancos de México por tamaño de activos. Inbursa ocupa el cuarto lugar nacional en créditos comerciales otorgados y mantiene cuotas cercanas al 5% en los principales segmentos bancarios, como ya se mencionó.</p>
<p>La influencia versatil de las compañías clave grupo Carso (incluyendo América Móvil, Telmex, entre otras) es tan grande que su valor bursátil conjunto equivale aproximadamente al 7.6% del PIB de México , y representan cerca del 18% de la capitalización total del mercado accionario nacional.</p>
<p>El análisis se basa en los precios históricos descargados desde Yahoo Finance, considerando para Grupo Carso datos desde el 14 de marzo del año 2000 hasta la fecha actual, y para Grupo Financiero Inbursa desde el 3 de enero del año 2000 hasta hoy. Estos periodos reflejan la disponibilidad completa de información bursátil proporcionada por la fuente.</p>
</section>
<section id="cálculo-de-los-log-rendimientos-diarios" class="level1">
<h1>Cálculo de los log-rendimientos diarios</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   symbol [1]
  symbol      date        returns
  &lt;chr&gt;       &lt;date&gt;        &lt;dbl&gt;
1 GFINBURO.MX 2000-01-03  0      
2 GFINBURO.MX 2000-01-04 -0.00517
3 GFINBURO.MX 2000-01-05 -0.00780
4 GFINBURO.MX 2000-01-06 -0.0238 
5 GFINBURO.MX 2000-01-07  0.0212 
6 GFINBURO.MX 2000-01-10  0.0460 </code></pre>
</div>
</div>
</section>
<section id="cálculo-de-descriptivos" class="level1">
<h1>Cálculo de descriptivos</h1>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">symbol</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">media</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mediana</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">desviacion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">asimetria</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">curtosis</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">minimo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maximo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GCARSOA1.MX</td>
<td style="text-align: right;">0.0006115</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0220712</td>
<td style="text-align: right;">0.8465848</td>
<td style="text-align: right;">28.90746</td>
<td style="text-align: right;">-0.2738252</td>
<td style="text-align: right;">0.3672959</td>
</tr>
<tr class="even">
<td style="text-align: left;">GFINBURO.MX</td>
<td style="text-align: right;">0.0003707</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0207556</td>
<td style="text-align: right;">-0.1702899</td>
<td style="text-align: right;">10.83786</td>
<td style="text-align: right;">-0.2574524</td>
<td style="text-align: right;">0.2148333</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="gráfico-de-densidad-histograma-boxplot-y-velas" class="level1">
<h1>Gráfico de densidad, histograma, boxplot y velas</h1>
<section id="historico" class="level2">
<h2 class="anchored" data-anchor-id="historico">Historico</h2>
<section id="histograma-historico" class="level3">
<h3 class="anchored" data-anchor-id="histograma-historico">Histograma historico</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/histograma%20historico-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/histograma%20historico-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot-historico" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-historico">Boxplot historico</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/boxplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-velas-historico" class="level3">
<h3 class="anchored" data-anchor-id="gráfico-de-velas-historico">Gráfico de velas historico</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/velas-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/velas-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="primer-trimestre-q1-2025" class="level2">
<h2 class="anchored" data-anchor-id="primer-trimestre-q1-2025">Primer trimestre (Q1) 2025</h2>
<section id="histograma-q3---2025" class="level3">
<h3 class="anchored" data-anchor-id="histograma-q3---2025">Histograma Q3 - 2025</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/histograma_Q3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/histograma_Q3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot-q1-2025" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-q1-2025">Boxplot Q1 2025</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/boxplot_1T2025-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="grafico-de-velas-q1-2023" class="level3">
<h3 class="anchored" data-anchor-id="grafico-de-velas-q1-2023">Grafico de velas Q1 2023</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/velas%20Q1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/velas%20Q1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="marzo-2025" class="level2">
<h2 class="anchored" data-anchor-id="marzo-2025">Marzo 2025</h2>
<section id="histograma-marzo---2025" class="level3">
<h3 class="anchored" data-anchor-id="histograma-marzo---2025">Histograma Marzo - 2025</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/histograma%20032025-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/histograma%20032025-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot-marzo-2025" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-marzo-2025">Boxplot Marzo 2025</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/boxplot_marzo2025-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-velas-marzo-2025" class="level3">
<h3 class="anchored" data-anchor-id="gráfico-de-velas-marzo-2025">Gráfico de velas Marzo 2025</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/velas%20marzo-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/velas%20marzo-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="estimación-de-parámetros-gaussianos-agregar-densidades-qqplot-y-distribución-empírica" class="level1">
<h1>Estimación de parámetros Gaussianos: Agregar densidades, qqplot y distribución empírica</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================
Ticker: GCARSOA1.MX 
(media estimada): 0.000611 
(desv. estándar estimada): 0.022071 
&gt;&gt; Shapiro-Wilk p-valor: 0 
&gt;&gt; Kolmogorov-Smirnov p-valor: 0 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/gauss-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================
Ticker: GFINBURO.MX 
(media estimada): 0.000371 
(desv. estándar estimada): 0.020756 
&gt;&gt; Shapiro-Wilk p-valor: 0 
&gt;&gt; Kolmogorov-Smirnov p-valor: 0 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/gauss-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pruebita" class="level1">
<h1>Pruebita</h1>
<p>Este código viene de los documentos en R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el paquete Runuran</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Runuran)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir los parámetros de la distribución de Meixner</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.0298</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.1271</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fl">0.5729</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.0011</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el objeto de distribución de Meixner</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>distr <span class="ot">&lt;-</span> <span class="fu">udmeixner</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, <span class="at">delta =</span> delta, <span class="at">mu =</span> mu)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un generador de números aleatorios utilizando el método de inversión</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">pinvd.new</span>(distr)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar una muestra de tamaño 100</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">ur</span>(gen, <span class="dv">100</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una secuencia de valores para evaluar la densidad</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la densidad para cada valor en x_vals</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>densidad <span class="ot">&lt;-</span> <span class="fu">ud</span>(distr, x_vals)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar la densidad</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x_vals, densidad, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Densidad de la distribución de Meixner"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"Densidad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/prueba%20meixner-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimación-de-parámetros-meixner-agregar-densidades-qqplot-y-distribución-empírica" class="level1">
<h1>Estimación de parámetros Meixner: Agregar densidades, qqplot y distribución empírica</h1>
<section id="momentos-empiricos" class="level2">
<h2 class="anchored" data-anchor-id="momentos-empiricos">Momentos Empiricos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir el ticker de prueba</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>accion <span class="ot">&lt;-</span> <span class="st">"GCARSOA1.MX"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>rendimientos_filtrados <span class="ot">&lt;-</span> rendimientos_activos <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(symbol <span class="sc">==</span> accion)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>rendimientos <span class="ot">&lt;-</span> rendimientos_filtrados<span class="sc">$</span>returns</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Momentos empiricos</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>media_emp <span class="ot">&lt;-</span> <span class="fu">mean</span>(rendimientos); media_emp       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0006114769</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>varianza_emp <span class="ot">&lt;-</span> <span class="fu">var</span>(rendimientos);varianza_emp         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0004871359</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>asimetria_emp <span class="ot">&lt;-</span> moments<span class="sc">::</span><span class="fu">skewness</span>(rendimientos); asimetria_emp  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8465848</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>curtosis_emp <span class="ot">&lt;-</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(rendimientos);curtosis_emp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28.90746</code></pre>
</div>
</div>
</section>
<section id="función-objetivo" class="level2">
<h2 class="anchored" data-anchor-id="función-objetivo">Función objetivo</h2>
<p>La función objetivo que estamos utilizando en la estimación por momentos es la suma de errores cuadráticos entre momentos empíricos y teóricos. Esta elección se basa en una idea sencilla; si queremos que una distribución se parezca a nuestros datos, una manera natural es exigir que sus momentos coincidan con los momentos que calculamos directamente de los datos. Como resolver este sistema de ecuaciones no es posible de forma exacta (por la complejidad no lineal de las expresiones), lo que hacemos es medir qué tan lejos están los momentos teóricos de los empíricos, y tratamos de encontrar los parámetros que minimicen esa diferencia. Usamos la suma de los errores al cuadrado porque penaliza más fuertemente las desviaciones grandes, evita que los errores se cancelen (como ocurriría si usáramos sumas simples), y además tiene propiedades matemáticas útiles: es una función suave, continua y derivable, lo que la hace ideal para métodos numéricos como los que usamos con <code>optim()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de pérdida (suma de errores cuadrados entre momentos teóricos y empíricos)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>loss_meixner <span class="ot">&lt;-</span> <span class="cf">function</span>(par) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> par[<span class="dv">1</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> par[<span class="dv">2</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> par[<span class="dv">3</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> par[<span class="dv">4</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Validación para evitar valores no válidos</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (a <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span> d <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span> b <span class="sc">&lt;=</span> <span class="sc">-</span>pi <span class="sc">||</span> b <span class="sc">&gt;=</span> pi) {<span class="fu">return</span>(<span class="cn">Inf</span>)}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Momentos teóricos </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  mu_teo <span class="ot">&lt;-</span> m <span class="sc">+</span> a <span class="sc">*</span> d <span class="sc">*</span> <span class="fu">tan</span>(b <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  var_teo <span class="ot">&lt;-</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> d) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">cos</span>(b <span class="sc">/</span> <span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  skew_teo <span class="ot">&lt;-</span> <span class="fu">sin</span>(b) <span class="sc">/</span> <span class="fu">sqrt</span>(d <span class="sc">*</span> (<span class="fu">cos</span>(b) <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  kurt_teo <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> (<span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">cos</span>(b <span class="sc">/</span> <span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> d</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  momentos_emp <span class="ot">&lt;-</span> <span class="fu">c</span>(media_emp, varianza_emp, asimetria_emp, curtosis_emp)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  momentos_teo <span class="ot">&lt;-</span> <span class="fu">c</span>(mu_teo, var_teo, skew_teo, kurt_teo)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Suma de errores al cuadrado</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((momentos_teo <span class="sc">-</span> momentos_emp)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La función <code>optim()</code> en R es una herramienta general para resolver problemas de minimización numérica. Su sintaxis básica incluye el argumento <code>par</code>, que representa el vector inicial de parámetros desde el cual comienza la búsqueda; <code>fn</code>, que es la función que se desea minimizar; y <code>method</code>, que indica el algoritmo de optimización a utilizar. Entre los métodos más comunes están <em>“BFGS”</em> (rápido, pero no permite restricciones), <em>“Nelder-Mead”</em> (más robusto, aunque más lento), y <em>“L-BFGS-B”</em>, que es el que usamos aquí porque permite establecer límites inferiores y superiores para cada parámetro.</p>
<p>Estos límites se definen mediante los argumentos <code>lower</code> y <code>upper</code>, los cuales son vectores en donde cada entrada representa una restricción para el parámetro correspondiente. En nuestro caso, significa que imponemos que <span class="math inline">\(a &gt; 0\)</span>, <span class="math inline">\(b &gt; -\pi\)</span>, <span class="math inline">\(d &gt; 0\)</span> , y dejamos <span class="math inline">\(m\)</span> sin límite inferior. De forma similar: limita razonablemente los valores máximos para ( a ), ( b ) y ( d ), y también deja libre a ( m ). Estas restricciones son esenciales para evitar que <code>optim()</code> explore regiones del espacio paramétrico donde las fórmulas de los momentos no están bien definidas, como por ejemplo al evaluar funciones trigonométricas en zonas donde podrían divergir o no estar definidas numéricamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>parametros_iniciales <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamar a optim</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ajuste <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> parametros_iniciales,  <span class="co"># valores iniciales de los parámetros</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> loss_meixner,  <span class="co"># la función que vamos a minimizar</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"L-BFGS-B"</span>, <span class="co"># metodo con limites</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="sc">-</span>pi <span class="sc">+</span> <span class="fl">0.01</span>, <span class="fl">0.0001</span>, <span class="sc">-</span><span class="cn">Inf</span>),  <span class="co"># límites inferiores</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">c</span>(<span class="dv">10</span>, pi <span class="sc">-</span> <span class="fl">0.01</span>, <span class="dv">100</span>, <span class="cn">Inf</span>)           <span class="co"># límites superiores</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver resultado</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ajuste<span class="sc">$</span>par)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          a           b           d           m 
0.104283141 0.245699574 0.039759572 0.006595164 </code></pre>
</div>
</div>
</section>
<section id="ajuste" class="level2">
<h2 class="anchored" data-anchor-id="ajuste">Ajuste</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>a_hat <span class="ot">&lt;-</span> ajuste<span class="sc">$</span>par[<span class="dv">1</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>b_hat <span class="ot">&lt;-</span> ajuste<span class="sc">$</span>par[<span class="dv">2</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>d_hat <span class="ot">&lt;-</span> ajuste<span class="sc">$</span>par[<span class="dv">3</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>m_hat <span class="ot">&lt;-</span> ajuste<span class="sc">$</span>par[<span class="dv">4</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la distribución Meixner ajustada</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>distr <span class="ot">&lt;-</span> <span class="fu">udmeixner</span>(<span class="at">alpha =</span> a_hat, <span class="at">beta =</span> b_hat, <span class="at">delta =</span> d_hat, <span class="at">mu =</span> m_hat)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Secuencia de valores para evaluar la densidad teórica</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(rendimientos), <span class="fu">max</span>(rendimientos), <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la densidad Meixner ajustada en esos puntos</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>densidad_meixner <span class="ot">&lt;-</span> <span class="fu">ud</span>(distr, x_vals)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear data frame para graficar</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>df_densidad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_vals,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">densidad =</span> densidad_meixner</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar histograma y densidad empírica vs Meixner</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(rendimientos), <span class="fu">aes</span>(<span class="at">x =</span> rendimientos)) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">150</span>, <span class="at">fill =</span> <span class="st">"orchid"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>,<span class="at">linetype=</span><span class="st">"dashed"</span> ) <span class="sc">+</span>  <span class="co"># Densidad empírica</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_densidad, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> densidad), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Densidad empírica vs Meixner ajustada - "</span>, accion),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rendimientos"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Para reproducibilidad</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>muestra_meixner <span class="ot">&lt;-</span> <span class="fu">ur</span>(<span class="fu">pinvd.new</span>(distr), <span class="at">n =</span> <span class="fu">length</span>(rendimientos))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame con cuantiles empíricos y Meixner simulados</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>qq_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">sort</span>(muestra_meixner),     <span class="co"># Cuantiles teóricos (Meixner)</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">sort</span>(rendimientos)         <span class="co"># Cuantiles empíricos (datos reales)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar el QQ plot</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qq_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"mediumorchid"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"QQ Plot - Meixner ajustada vs datos reales: "</span>, accion),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cuantiles teóricos (Meixner)"</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cuantiles empíricos (rendimientos)"</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Meixner_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="resolución-numérica-de-la-ecuación-martingala-meixner" class="level1">
<h1>Resolución numérica de la ecuación martingala Meixner</h1>
</section>
<section id="densidades-meixner-y-gaussiano-en-el-mundo-riesgo-neutro" class="level1">
<h1>Densidades Meixner y Gaussiano en el mundo riesgo neutro</h1>
</section>
<section id="prima-black-scholes-europea" class="level1">
<h1>Prima Black-Scholes Europea</h1>
</section>
<section id="prima-meixner-europea" class="level1">
<h1>Prima Meixner Europea</h1>
</section>
<section id="prima-americana-arbol-forward" class="level1">
<h1>Prima Americana Arbol Forward</h1>
</section>
<section id="simulaciones-gaussianas" class="level1">
<h1>Simulaciones Gaussianas</h1>
</section>
<section id="simulaciones-meixner" class="level1">
<h1>Simulaciones Meixner</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>